# PDF Analysis and Print Fix Tools
A collection of Python utilities for analyzing PDF structure, fixing PDF compatibility issues with print services, and combining multiple PDFs.

## Scripts

### 1. analyze_pdf_size.py
Analyzes PDF files to understand their structure, extract embedded images, and identify size optimization opportunities.

**Features:**
- Reports total page count and individual page dimensions
- Extracts all embedded images from the PDF
- Identifies unique images vs. duplicate usage across pages
- Shows image positions on each page (top-left, bottom-right, etc.)
- Calculates size breakdown: images vs. other content
- Provides optimization recommendations
- Exports extracted images as separate files

**Usage:**
```python
# Edit the pdf_path variable in the script
pdf_path = r"C:\path\to\your\file.pdf"

# Run the script
python analyze_pdf_size.py
```

**Requirements:**
- PyPDF2

**Output:**
- Console output with detailed analysis
- Extracted images saved as `extracted_image_*.jpg` in the working directory

### 2. FixPDFToPrint.py
Rebuilds PDF files using Ghostscript to fix compatibility issues with print services, particularly for PDFs generated by XeLaTeX or other sources that may have non-standard formatting.

**Features:**
- Rebuilds PDF with Ghostscript for maximum compatibility
- Optionally removes first and/or last pages
- Embeds and subsets all fonts
- Preserves color profiles
- Maintains high quality (prepress settings)
- Reports original vs. new file size

**Usage:**
```python
# Edit the input/output paths and options in the script
input_file = r"E:\path\to\input.pdf"
output_file = r"E:\path\to\output.pdf"

# Set page removal options
REMOVE_FIRST_PAGE = False
REMOVE_LAST_PAGE = False

# Run the script
python FixPDFToPrint.py
```

**Requirements:**
- PyPDF2
- Ghostscript (must be installed and in PATH)
  - Windows: `gswin64c.exe`
  - Ensure Ghostscript is installed from https://ghostscript.com/

**Ghostscript Settings:**
- Compatibility Level: 1.4
- PDF Settings: /prepress (high quality)
- Embeds and subsets all fonts
- Preserves image quality (no downsampling)
- Maintains original color conversion strategy

### 3. combine_pdfs.py
Combines multiple PDF files into a single PDF document, preserving all pages in the order specified.

**Features:**
- Merges multiple PDF files into one output file
- Preserves all pages from each input PDF
- Maintains page order based on input file order
- Simple file path configuration
- Error handling with clear success/failure feedback

**Usage:**
```python
# Edit the input folder, file list, and output path in the script
input_folder = "E:/code/GIT_pythontoys/FixPDFToPrint/"
input_files = ["only1.pdf", "only2.pdf", "only3.pdf"]
output_file = input_folder + "output.pdf"

# Run the script
python combine_pdfs.py
```

**Requirements:**
- PyPDF2

**Output:**
- Single combined PDF file at the specified output path
- Console confirmation with file count and output location

**Example:**
```bash
âœ“ Successfully combined 3 PDFs into E:/code/GIT_pythontoys/FixPDFToPrint/output.pdf
```

## Installation

1. Install Python dependencies:
```bash
pip install PyPDF2
```

2. Install Ghostscript (only required for `FixPDFToPrint.py`):
   - Download from https://ghostscript.com/releases/gsdnld.html
   - Install and ensure it's added to your system PATH
   - Verify installation: `gswin64c --version` (Windows) or `gs --version` (Linux/Mac)

## Common Use Cases

**Analyzing PDF Size:**
Use `analyze_pdf_size.py` when you need to:
- Understand why a PDF is large
- Identify oversized images
- Find duplicate images
- Get recommendations for size optimization

**Fixing Print Compatibility:**
Use `FixPDFToPrint.py` when:
- PDFs fail to print at print services
- You need to ensure maximum compatibility
- Fonts aren't embedding properly
- PDFs generated by XeLaTeX need normalization

**Combining Multiple PDFs:**
Use `combine_pdfs.py` when you need to:
- Merge multiple separate PDF files into one document
- Combine chapters or sections into a complete document
- Create a single file for easier distribution
- Prepare multi-part documents for printing

## Notes
- All scripts use hardcoded file paths - edit the paths in the `__main__` section before running
- `FixPDFToPrint.py` creates a temporary file if page removal is enabled
- `combine_pdfs.py` preserves the exact page order specified in the input_files list
- Ghostscript executable name is `gswin64c.exe` on Windows 64-bit
- The analyze script extracts images in their compressed format (typically JPEG)

## License
These scripts are provided as-is for personal and commercial use.
