# PDF Analysis and Print Fix Tools

A collection of Python utilities for analyzing PDF structure and fixing PDF compatibility issues with print services.

## Scripts

### 1. analyze_pdf_size.py

Analyzes PDF files to understand their structure, extract embedded images, and identify size optimization opportunities.

**Features:**
- Reports total page count and individual page dimensions
- Extracts all embedded images from the PDF
- Identifies unique images vs. duplicate usage across pages
- Shows image positions on each page (top-left, bottom-right, etc.)
- Calculates size breakdown: images vs. other content
- Provides optimization recommendations
- Exports extracted images as separate files

**Usage:**
```python
# Edit the pdf_path variable in the script
pdf_path = r"C:\path\to\your\file.pdf"

# Run the script
python analyze_pdf_size.py
```

**Requirements:**
- PyPDF2

**Output:**
- Console output with detailed analysis
- Extracted images saved as `extracted_image_*.jpg` in the working directory

### 2. FixPDFToPrint.py

Rebuilds PDF files using Ghostscript to fix compatibility issues with print services, particularly for PDFs generated by XeLaTeX or other sources that may have non-standard formatting.

**Features:**
- Rebuilds PDF with Ghostscript for maximum compatibility
- Optionally removes first and/or last pages
- Embeds and subsets all fonts
- Preserves color profiles
- Maintains high quality (prepress settings)
- Reports original vs. new file size

**Usage:**
```python
# Edit the input/output paths and options in the script
input_file = r"E:\path\to\input.pdf"
output_file = r"E:\path\to\output.pdf"

# Set page removal options
REMOVE_FIRST_PAGE = False
REMOVE_LAST_PAGE = False

# Run the script
python FixPDFToPrint.py
```

**Requirements:**
- PyPDF2
- Ghostscript (must be installed and in PATH)
  - Windows: `gswin64c.exe`
  - Ensure Ghostscript is installed from https://ghostscript.com/

**Ghostscript Settings:**
- Compatibility Level: 1.4
- PDF Settings: /prepress (high quality)
- Embeds and subsets all fonts
- Preserves image quality (no downsampling)
- Maintains original color conversion strategy

## Installation

1. Install Python dependencies:
```bash
pip install PyPDF2
```

2. Install Ghostscript:
   - Download from https://ghostscript.com/releases/gsdnld.html
   - Install and ensure it's added to your system PATH
   - Verify installation: `gswin64c --version` (Windows) or `gs --version` (Linux/Mac)

## Common Use Cases

**Analyzing PDF Size:**
Use `analyze_pdf_size.py` when you need to:
- Understand why a PDF is large
- Identify oversized images
- Find duplicate images
- Get recommendations for size optimization

**Fixing Print Compatibility:**
Use `FixPDFToPrint.py` when:
- PDFs fail to print at print services
- You need to ensure maximum compatibility
- Fonts aren't embedding properly
- PDFs generated by XeLaTeX need normalization

## Notes

- Both scripts use hardcoded file paths - edit the paths in the `__main__` section before running
- `FixPDFToPrint.py` creates a temporary file if page removal is enabled
- Ghostscript executable name is `gswin64c.exe` on Windows 64-bit
- The analyze script extracts images in their compressed format (typically JPEG)

## License

These scripts are provided as-is for personal and commercial use.
